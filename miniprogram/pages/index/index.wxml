<view class="page">
  <!-- 自动登录检测中 -->
  <view class="auto-login-wrap" wx:if="{{autoLogging}}">
    <text class="emoji" style="font-size:80rpx;">📋</text>
    <text class="auto-login-text">正在登录...</text>
  </view>

  <!-- 正常邀请码输入页 -->
  <view wx:if="{{!autoLogging}}">
    <!-- 顶部 -->
    <view class="header">
      <text class="emoji">📋</text>
      <text class="title">TB报名登记</text>
    </view>

    <!-- 输入区 -->
    <view class="card">
      <text class="label">请输入6位邀请码</text>
      <input
        type="text"
        value="{{code}}"
        bindinput="onInput"
        placeholder="点击输入邀请码"
        maxlength="6"
        class="input"
      />

      <!-- ★ 隐私协议勾选框 -->
      <view class="privacy-check-row">
        <view class="checkbox-wrap" bindtap="togglePrivacyCheck">
          <view class="checkbox {{privacyChecked ? 'checked' : ''}}">
            <text wx:if="{{privacyChecked}}" class="check-icon">✓</text>
          </view>
        </view>
        <view class="privacy-check-text-wrap">
          <text class="privacy-check-text">我已阅读并同意</text>
          <text class="privacy-check-link" bindtap="openPrivacyDetail">《用户隐私保护指引》</text>
        </view>
      </view>

      <button
        class="btn-main"
        bindtap="onSubmit"
        disabled="{{loading || code.length < 6 || !privacyChecked}}"
      >{{loading ? '验证中...' : '开始报名'}}</button>
    </view>

    <!-- 提示 -->
    <view class="tips">
      <text>如何获取邀请码？\n• 通过已报名用户分享\n• 关注公众号获取</text>
    </view>

    <!-- 已注册用户直接登录 -->
    <button class="btn-relogin" bindtap="onRelogin" disabled="{{loading || !privacyChecked}}">已报名？直接登录</button>
    <text class="relogin-hint" wx:if="{{!privacyChecked}}">请先勾选同意隐私保护指引</text>

    <!-- 开发按钮 -->
    <button class="btn-dev" wx:if="{{devMode}}" bindtap="onDevSkip">开发模式：跳过验证</button>
  </view>
</view>
