<view class="page">
  <!-- 自动登录检测中 -->
  <view class="auto-login-wrap" wx:if="{{autoLogging}}">
    <view class="auto-login-icon">📋</view>
    <text class="auto-login-text">正在登录...</text>
  </view>

  <!-- 正常页面 -->
  <view wx:if="{{!autoLogging}}">
    <!-- 顶部品牌 -->
    <view class="hero">
      <view class="hero-icon">📋</view>
      <text class="hero-title">TB报名登记</text>
    </view>

    <!-- 邀请码输入卡片 -->
    <view class="card invite-card">
      <text class="invite-label">请输入6位邀请码</text>
      <input
        type="text"
        value="{{code}}"
        bindinput="onInput"
        placeholder="点击输入邀请码"
        maxlength="6"
        class="code-input"
      />

      <!-- 隐私协议勾选 -->
      <view class="privacy-row" bindtap="togglePrivacyCheck">
        <view class="ck {{privacyChecked ? 'ck-on' : ''}}">
          <text wx:if="{{privacyChecked}}" class="ck-icon">✓</text>
        </view>
        <view class="privacy-text-wrap">
          <text class="privacy-text">我已阅读并同意</text>
          <text class="privacy-link" catchtap="openPrivacyDetail">《用户隐私保护指引》</text>
        </view>
      </view>

      <button
        class="btn-start"
        bindtap="onSubmit"
        disabled="{{loading || code.length < 6 || !privacyChecked}}"
      >{{loading ? '验证中...' : '开始报名'}}</button>
    </view>

    <!-- 提示 -->
    <view class="hint-box">
      <text class="hint-text">如何获取邀请码？\n• 通过已报名用户分享\n• 关注公众号获取</text>
    </view>

    <!-- 已注册用户直接登录 -->
    <button
      class="btn-relogin"
      bindtap="onRelogin"
      disabled="{{loading || !privacyChecked}}"
    >已报名？直接登录</button>
    <text class="relogin-hint" wx:if="{{!privacyChecked}}">请先勾选同意隐私保护指引</text>
  </view>
</view>
